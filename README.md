# Weather Service Project

## Objective

The brief for this project was:

> Write an HTTP server that uses the Open Weather API that exposes an endpoint that takes in lat/long coordinates. 
This endpoint should return the weather conditions in that area (snow, rain, etc), 
whether itâ€™s hot, cold, or moderate outside (use your own discretion on what temperature equates to each type), 
and whether there are any weather alerts in that area along with the weather conditions related to the alert.
The API can be found here: https://openweathermap.org/api. 
The one-call api returns all the data while the other apis are piece-mealed sections.
You may also find the https://openweathermap.org/faq useful.

## Running the Service

The service requires an Open Weather API Key that has the One Call API 3.0 subscription.
This is defined in the `application.conf` resource file as an environment variable:

``API_KEY=ecfdbdd56ffe97cfccdf2fc1d741ecd3``

To run the service:
- Define the API_KEY environment variable.
- Run the entry point `WeatherServiceApp` (i.e., in the root package).
- Do an HTTP GET on service entry point (e.g., browser, Postman).

For example, a GET using the following URL:

``http://localhost:8080/current-weather?lat=43.677&lon=-79.402``

...will produce a JSON entity similar to:

```json
{
  "conditions": "Clouds",
  "temperature": "Warm",
  "alerts": [
    {
      "event": "weather",
      "description": "Conditions will be favourable for the development of funnel clouds this afternoon and evening.\n\n###\n\nThese types of funnel clouds are generated by weak rotation under rapidly growing clouds or weak thunderstorms. This weak rotation is normally not a danger near the ground. However, there is a chance that this rotation could intensify and become a weak landspout tornado.\n\nLandspout tornadoes do not usually cause significant damage but can still be dangerous. They can be strong enough to topple trees, damage roofs or toss debris short distances.\n\nPlease continue to monitor alerts and forecasts issued by Environment Canada. To report severe weather, send an email to ONstorm@ec.gc.ca or tweet reports using #ONStorm.",
      "conditions": [
        "Other dangers"
      ]
    },
    {
      "event": "rainfall",
      "description": "Rain, at times heavy, continues.\n\nHazard:\nLocalized heavy rainfall with 50 to 75 mm possible.\n\nTiming:\nEnding this evening.\n\nDiscussion:\nHeavy showers and isolated thunderstorms are expected to continue on and off throughout the day. These showers and thunderstorms are very slow moving and some areas may receive significant rainfall amounts.\n\nFor information concerning flooding, please consult your local Conservation Authority or Ontario Ministry of Natural Resources and Forestry office. Visit Ontario.ca/floods for the latest details.\n\n###\n\nHeavy downpours can cause flash floods and water pooling on roads. Localized flooding in low-lying areas is possible. Heavy rainfall in combination with other weather factors, such as hail, wind and lightning will make outdoor activities unsafe.\n\nPlease continue to monitor alerts and forecasts issued by Environment Canada. To report severe weather, send an email to ONstorm@ec.gc.ca or tweet reports using #ONStorm.",
      "conditions": [
        "Rain"
      ]
    }
  ]
}
```

## Implementation

This service is implemented using Cats Effect, Circe, http4s and PureConfig.
The [Open Weather One Call 3.0](https://openweathermap.org/api/one-call-3) is
used to provide the weather data.

The implementation uses the IO effect type directly (i.e., not tagless final)
to keep the example as simple as possible.

All the code and resources are in the root package. 
The main Scala implementation files in the project are:
* **AppConfig** - Decoding and validating configuration using PureConfig.
* **CurrentWeatherService** - The implementation of the `weather-service` route that
retrieves data from the Open Weather One Call API service and transforms it to
the service's current weather summary representation.
* **OpenWeatherData** - The binding of (a subset of) the Open Weather One Call data
to case class representation, as well as a transformation of that representation to
the result format.
* **ParameterDecoders** - Decoders for the `lat` and `lon` query string parameters.
* **WeatherServiceApp** - The entry point that instantiates the HTTP Server.

## Limitations

The handling of validated query parameters (in `CurrentWeatherService`) seems awkward.

There is limited unit testing: a single unit test in `OpenWeatherDataSpec`.
This is useful for documenting this project's interpretation of the data returned
by the Open Weather One Call API, and the transformed version of this data that is
returned as the `current-weather` service result. While this is the most interesting
bit to unit test, it is not a complete suite of unit tests.

This project is not intended to show best practices for a RESTful API.
